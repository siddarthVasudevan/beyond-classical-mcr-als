# Beyond Classical MCR-ALS

This repository contains datasets and the code used for analyzing and plotting the results
from the datasets referenced in the following paper


## Repository Structure

The repository contains datasets, results from analysis of the datasets, and codes
for both analysis and visualization of the datasets.

### Datasets Directory

The **datasets** directiory contains two subdirectories **raman** and **rxn** which contains
the respective datasets.

1. **raman** directory: contains 3 csv files, *raman.csv*, *raman_raw.csv*, and *known_H_raman.csv*.
   The *raman.csv* contains the corrected raman data, the *raman_raw.csv* contains the raw Raman
   data, and the *known_H_raman.csv* contains the known concentration values at the values. The
   nan entries in *known_H_raman.csv* correspond to unknown concentration timepoints.

2. **rxn** subdirectory: contains several csv files. All csv filenames starting with *X_100dPt_*
   contain the spectral data corresponding to either Rxn1 or Rxn2 dataset with a specific noise
   level. The csv filenames starting with *H_100dPt_* contains the groundtruth of the rnx1 and
   rxn2 datsets. *pure_spectra.csv* file contains the ground truth of the pure spectra without
   noise used for generating the spectral data of rxn1 and rxn2 datasets.

### Scripts

See the module level docstrings for each .py file does. A short summary is provided below:

- **gen_rxn_dset.py**: Generates the rxn1 and rxn2 datasets and saves it to the path *./datasets/rnx/*

- **rxn_dset_analysis.py**: Analysis for rxn dataset with varying noise levels for different
  combinations of known concentrations. The results generated are saved to the path *./rxn-comb-results/*. **Note**: this script can take from several minutes to few hours to run
  depending on the number of cores present in the computer where it is running from.

- **gen_rxn_dset_plots.py**: generates all the visualizations shown in the main article and SI
  of the paper for the Rxn dataset

- **analyze_and_gen_raman_dset_plots.py**: Analyzes and generates visualizations shown in the main
  article of the paper for the Raman dataset.

- **example_rxn2_plots_in_SI.py**: Creates visualizations of NMF results for Rxn2 dataset, shown
  in the SI of the paper.

- **figure_templates.py**: Utility module for creating the templates for the figures shown in the
  main article and SI of the paper.

### raman-figures directory

Contains the figures generated by analyzing and visualizing the Raman dataset. These figures
are generated by running the script *analyze_and_gen_raman_dset_plots.py*

### rxn-comb-results directory

Contains the results generated by analyzing the Rxn dataset. These results are generated by
running the script *rxn_dset_analysis.py*

### rxn-figures directory

Contains the figures generated by visualizing the results in the directory *rxm-comb-results*.
These figures are generated by running the script *gen_rxn_dset_plots.py*.

## Usage

Since the scripts uses relative path variables to access datasets and results, they must
be run from the directory where the scripts reside.

1. Generate synthetic data:
```bash
cd beyond-classical-mcr-als
python gen_rxn_dset.py
```

### Dependencies

Running the scripts requires the following packages, which can be downloaded from conda-forge.

* mcrnmf
* Numpy
* Pandas
* Matplotlib
* SciPy
* Scikit-learn
* Joblib

The *environment.txt* file is provided for convenience, which can be used for installing
the correct dependencies on which these scripts were tested.